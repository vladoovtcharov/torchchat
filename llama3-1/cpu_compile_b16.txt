
python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"float16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --compile --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"float16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --compile --num-samples 3
W1031 17:18:42.414000 63819 .venv/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/redirects.py:29] NOTE: Redirects are currently not supported in Windows or MacOs.
Using device=cpu Apple M1 Max
Loading model...
Time to load model: 2.11 seconds
Quantizing the model with: {'precision': {'dtype': 'float16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 0.00 seconds
-----------------------------------------------------------
Once upon a time, in the lovely town of Stirling, Scotland, there lived a young girl named Sophie. Sophie was a bright and curious child, always eager to learn and explore the world around her.
One day, while wandering through the town's historic streets, Sophie stumbled upon a small, mysterious shop tucked away in a quiet alley. The sign above the door read "Dr. MacTavish's Curious Commissions." Sophie's curiosity was piqued, and she pushed open the door to venture inside.
Dr. MacTavish, a bespectacled and eccentric old man with a wild shock of white hair, looked up from behind his cluttered desk and greeted Sophie with a warm smile. "Ah, welcome, young lady! I've been expecting you. You seem like someone with a taste for adventure and a penchant for the unusual."
Sophie's eyes widened as she scanned the shop's shelves, which were stacked high with all manner of curious objects: vintage clockwork mechanisms, rare books bound in leather, and glittering crystals nestled among wooden carvings. "What is this place?" Sophie asked, her voice barely above a whisper.

Dr. MacTavish chuckled. "This, my dear, is a place where the ordinary and the2024-10-31:17:19:34,974 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 1: 50.2530 sec total                 
Time to first token: 0.3401 sec with parallel prefill.                

      Total throughput: 5.0942 tokens/sec, 0.1963 s/token                 
First token throughput: 2.9401 tokens/sec, 0.3401 s/token                 
 Next token throughput: 5.1089 tokens/sec, 0.1957 s/token                     
2024-10-31:17:19:34,974 INFO     [generate.py:1173] 
Bandwidth achieved: 81.82 GB/s
2024-10-31:17:19:34,974 INFO     [generate.py:1177] *** This first iteration will include cold start effects for dynamic import, hardware caches, JIT compilation. ***
just-in-time compilation time (incl run time): 5e+01 seconds

========================================

Once upon a time, there was a city that was plagued by an endless supply of cats. They were everywhere, scurrying about on the sidewalks, lounging in the sunbeams that streamed through the windows, and even sleeping in the park. The city was called Cat-Haven, and it was a place where no animal was more welcome than a feline.
The people of Cat-Haven loved their cats dearly. They fed them, petted them, and even built cat cafes and cat museums to honor their feline friends. But as the years passed, the cats began to multiply at an alarming rate. They were everywhere, and no one knew how to stop it.
One day, a young girl named Lily noticed that the cats seemed to be getting more and more aggressive. They would hiss and spit at people, and even attack occasional visitors to the city. Lily was worried, and she decided to investigate the source of the problem.
She spent hours scouring the city, talking to cat owners and watching the behavior of the cats. And then, she stumbled upon a mysterious figure - an old woman who lived on the outskirts of the city, surrounded by a sprawling cat sanctuary.
The old woman, whose name was Winnie, was a renowned cat breeder, but Lily soon2024-10-31:17:20:11,927 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 2: 36.9538 sec total                 
Time to first token: 0.3023 sec with parallel prefill.                

      Total throughput: 6.9276 tokens/sec, 0.1444 s/token                 
First token throughput: 3.3075 tokens/sec, 0.3023 s/token                 
 Next token throughput: 6.9574 tokens/sec, 0.1437 s/token                     
2024-10-31:17:20:11,927 INFO     [generate.py:1173] 
Bandwidth achieved: 111.26 GB/s

========================================

Once upon a time, the United States was a relatively simple country, not yet globalized. Trade and commerce were mainly local, and America's economy was heavily based on agriculture, manufacturing, and mining. However, as the nation expanded and the world became smaller due to the advent of international communication and transportation technologies, the United States also underwent globalization. The late 20th century saw the emergence of the United States as a global leader in a globalized economy, and a significant portion of this expansion was fueled by technological advancements. The rise of the internet and related digital technologies has played a crucial role in this expansion, and the two have had a symbiotic relationshipâ€”driving globalization and being driven by it.
When the United States first began to globalize, trade agreements and policies, international institutions like the G20 and the World Trade Organization (WTO), and multinational corporations were established to promote the exchange of goods and services across international borders. The emergence of global supply chains led to a division of labor among nations, where different countries specialized in producing specific products in order to lower costs and increase efficiency. This increased interdependence among economies also led to the establishment of regional trade agreements, such as the North American Free Trade Agreement (NAFTA) and the European Union's (EU) single market2024-10-31:17:20:51,041 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 3: 39.1144 sec total                 
Time to first token: 0.3229 sec with parallel prefill.                

      Total throughput: 6.5449 tokens/sec, 0.1528 s/token                 
First token throughput: 3.0974 tokens/sec, 0.3229 s/token                 
 Next token throughput: 6.5736 tokens/sec, 0.1521 s/token                     
2024-10-31:17:20:51,042 INFO     [generate.py:1173] 
Bandwidth achieved: 105.11 GB/s

========================================


      Average tokens/sec (total): 6.19                 
Average tokens/sec (first token): 3.11                 
Average tokens/sec (next tokens): 6.21 
                
