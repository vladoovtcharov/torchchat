
python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"float16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py generate llama3.1 --quantize '{"precision": {"dtype":"float16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
W1031 17:13:18.600000 63000 .venv/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/redirects.py:29] NOTE: Redirects are currently not supported in Windows or MacOs.
Using device=cpu Apple M1 Max
Loading model...
Time to load model: 2.50 seconds
Quantizing the model with: {'precision': {'dtype': 'float16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 0.00 seconds
-----------------------------------------------------------
Once upon a time, in the ancient city of Nablus, Palestine, a young shepherd boy named Gideon lived a simple life. He wearable the tunic and belt of his ancestors, and carried the staff of his father gears his way to the hills. As he sat on the mountain, scanning the horizon, he envisioned the vast lands that lay beyond his vision. His heart yearned for adventure, and his spirit was restless. Little did he know, the horizon was calling him to embark on a journey that would change his life forever.
As the night descended, Gideon saw a vision of an angelic figure, radiant and of unutterable light, standing before him. The angel spoke, saying, 'Gideon, I will be with you, and you will strike down the enemies of God.' Gideon, trembling with fear, replied, 'Who am I to do this mighty deed?' The angel replied, 'You are a mighty warrior, and I will be with you.' Gideon knew that he was being called to a great and perilous task.
With the Angel's blessing, Gideon readied himself for battle. He assembled a band of 32,000 warriors, but the angel appeared to him once more, saying, 'The people are too many;2024-10-31:17:14:07,485 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 1: 46.1781 sec total                 
Time to first token: 0.3827 sec with parallel prefill.                

      Total throughput: 5.5438 tokens/sec, 0.1804 s/token                 
First token throughput: 2.6130 tokens/sec, 0.3827 s/token                 
 Next token throughput: 5.5682 tokens/sec, 0.1796 s/token                     
2024-10-31:17:14:07,485 INFO     [generate.py:1173] 
Bandwidth achieved: 89.04 GB/s
2024-10-31:17:14:07,485 INFO     [generate.py:1177] *** This first iteration will include cold start effects for dynamic import, hardware caches. ***

========================================

Once upon a time, there was a young girl named Sophia who lived in a small village surrounded by rolling hills and vast farmland. Sophia was fascinated by the stories of her grandmother, who used to tell her about the old ways of farming and the magic that lay in the earth.

One day, Sophia's grandmother took her to a secret place in the hills where the soil was rich and the air was sweet with the scent of wildflowers. Sophia's grandmother showed her how to dig a garden, how to plant seeds, and how to talk to the earth. Sophia was enchanted by the simple yet profound rituals of farming and vowed to carry on the traditions of her family.

As Sophia grew up, she became a skilled farmer, beloved by her community for her knowledge of the land and her ability to coax life from even the most barren soil. But Sophia's true secret was her conversations with the earth. She would spend hours talking to the plants, listening to their whispers, and asking for their guidance.

The earth, in turn, would share its secrets with Sophiatoast. She could hear the whispers of the ancient trees, the rustle of leaves, and the gentle hum of the wind. The earth shared its wisdom with Sophia, teaching her about the cycles of life and death, the balance of2024-10-31:17:14:53,318 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 2: 45.8316 sec total                 
Time to first token: 0.3490 sec with parallel prefill.                

      Total throughput: 5.5857 tokens/sec, 0.1790 s/token                 
First token throughput: 2.8657 tokens/sec, 0.3490 s/token                 
 Next token throughput: 5.6065 tokens/sec, 0.1784 s/token                     
2024-10-31:17:14:53,318 INFO     [generate.py:1173] 
Bandwidth achieved: 89.71 GB/s

========================================

Once upon a time, in the heart of a bustling city, there was a small, eclectic bookstore. The store was called "Page & Co." and it was a haven for book lovers of all ages. The owner, a kind and knowledgeable woman named Emily, had a passion for collecting rare and unique books that she would lovingly display on her shelves.
One day, a young girl named Sophie wandered into Page & Co. searching for a specific book. She had heard about a legendary novel written by a reclusive author, and she was determined to find a copy. As she browsed the shelves, Sophie's eyes landed on a beautiful, leather-bound book with gold lettering on the cover.
The book was titled "The Whispering Winds of Whimsy," and it was said to be a first edition, signed by the author. Sophie's heart skipped a beat as she carefully opened the book, inhaling the musty scent of aged paper. As she began to read, she was transported to a world of wonder and magic.
But, as Sophie delved deeper into the book, she started to notice strange occurrences. The words on the pages began to shift and change, and the illustrations seemed to move on their own consid ering the whims that the author had written. The2024-10-31:17:15:39,699 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 3: 46.3778 sec total                 
Time to first token: 0.4744 sec with parallel prefill.                

      Total throughput: 5.5199 tokens/sec, 0.1812 s/token                 
First token throughput: 2.1079 tokens/sec, 0.4744 s/token                 
 Next token throughput: 5.5551 tokens/sec, 0.1800 s/token                     
2024-10-31:17:15:39,699 INFO     [generate.py:1173] 
Bandwidth achieved: 88.65 GB/s

========================================


      Average tokens/sec (total): 5.55                 
Average tokens/sec (first token): 2.53                 
Average tokens/sec (next tokens): 5.58 
                
