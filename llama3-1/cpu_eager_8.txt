
python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"float16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
python3 torchchat.py generate llama3.1 --quantize '{"linear:int8": {"groupsize": 0}, "precision": {"dtype":"float16"}, "executor":{"accelerator":"cpu"}}' --prompt "Once upon a time," --max-new-tokens 256 --num-samples 3
W1031 17:15:45.726000 63443 .venv/lib/python3.12/site-packages/torch/distributed/elastic/multiprocessing/redirects.py:29] NOTE: Redirects are currently not supported in Windows or MacOs.
Using device=cpu Apple M1 Max
Loading model...
Time to load model: 2.15 seconds
Quantizing the model with: {'linear:int8': {'groupsize': 0}, 'precision': {'dtype': 'float16'}, 'executor': {'accelerator': 'cpu'}}
Time to quantize model: 9.13 seconds
-----------------------------------------------------------
Once upon a time, there was a blind man who wanted to know the world. His name was Rajan and he was a visually impaired person from a small village in India. In a world where sight is often equated with knowledge and understanding, Rajan’s limitations seemed insurmountable. But he refused to be bound by his blindness. Rajan was determined to experience life on his own terms.
One day, while exploring the village, Rajan stumbled upon a small music shop. The owner, a kind old man named Kumar, took a liking to Rajan and decided to take him under his wing. Kumar, a skilled musician himself, began teaching Rajan the art of music. At first, it was tough for Rajan to learn, but his dedication and passion soon made up for his lack of sight.
Kumar taught Rajan how to play the sitar, an Indian stringed instrument. Rajan’s fingers moved deftly over the strings, creating beautiful melodies that filled the air. As he played, Rajan began to imagine the world around him. He pictured vibrant colors, heard the sweet songs of birds, and even felt the rhythm of the music coursing through his veins.
Music became Rajan’s gateway to understanding the world. He learned to perceive it2024-10-31:17:16:49,072 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 1: 51.8427 sec total                 
Time to first token: 0.7056 sec with parallel prefill.                

      Total throughput: 4.9380 tokens/sec, 0.2025 s/token                 
First token throughput: 1.4173 tokens/sec, 0.7056 s/token                 
 Next token throughput: 4.9866 tokens/sec, 0.2005 s/token                     
2024-10-31:17:16:49,072 INFO     [generate.py:1173] 
Bandwidth achieved: 42.26 GB/s
2024-10-31:17:16:49,072 INFO     [generate.py:1177] *** This first iteration will include cold start effects for dynamic import, hardware caches. ***

========================================

Once upon a time, in a small village nestled in the rolling hills of the countryside, there lived a young girl named Sophie. She was a curious and adventurous child, with a heart full of wonder and a mind full of questions. Sophie loved to explore the world around her, and she spent most of her days playing outside, discovering new things, and learning about the world.
One day, Sophie stumbled upon a mysterious and ancient-looking door hidden behind a thick veil of foliage. The door was old and worn, with intricate carvings and strange symbols etched into its surface. Sophie's curiosity was piqued, and she felt an overwhelming urge to open the door and see what lay beyond.
As she reached out to touch the door, a low, rumbling voice whispered in her ear, "Welcome, Sophie. I have been waiting for you." Sophie spun around, but there was no one in sight. She turned back to the door, and as she did, it swung open with a creak, revealing a dimly lit hallway that stretched out into the darkness.
Sophie's heart pounded with excitement and a touch of fear as she stepped through the doorway and into the unknown. She found herself in a narrow corridor, lined with cobweb-covered portraits and flickering candles that2024-10-31:17:17:44,846 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 2: 55.7742 sec total                 
Time to first token: 0.6952 sec with parallel prefill.                

      Total throughput: 4.5899 tokens/sec, 0.2179 s/token                 
First token throughput: 1.4385 tokens/sec, 0.6952 s/token                 
 Next token throughput: 4.6297 tokens/sec, 0.2160 s/token                     
2024-10-31:17:17:44,846 INFO     [generate.py:1173] 
Bandwidth achieved: 39.28 GB/s

========================================

Once upon a time, in a small village nestled in the rolling hills of the countryside, there lived a young girl named Sophia. Sophia was a curious and adventurous child, with a heart full of wonder and a mind full of questions. She loved to explore the world around her, and was always eager to learn new things.
One day, Sophia heard a rumor about a hidden garden, deep in the nearby woods, that was said to be the most beautiful garden in all the land. The garden was rumored to be filled with the most vibrant and exotic flowers, trees, and plants that anyone had ever seen.
Sophia was immediately captivated by the idea of this hidden garden, and she begged her parents to take her to see it. Her parents told her that they had heard the rumor too, but they were skeptical. They warned her that the woods could be dangerous, and that the garden might be just a myth.
But Sophia was determined. She packed a small bag with some snacks and a bottle of water, and set off into the woods to find the hidden garden. She walked for what felt like hours, following a winding path that led her through(debug)//forest. As she walked, the trees grew taller and the underbrush thicker, and Sophia began to feel a little scared. She2024-10-31:17:18:35,983 INFO     [generate.py:1162] 
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~                
Generated 255 tokens                 
Time for inference 3: 51.1379 sec total                 
Time to first token: 0.7373 sec with parallel prefill.                

      Total throughput: 5.0061 tokens/sec, 0.1998 s/token                 
First token throughput: 1.3563 tokens/sec, 0.7373 s/token                 
 Next token throughput: 5.0595 tokens/sec, 0.1976 s/token                     
2024-10-31:17:18:35,983 INFO     [generate.py:1173] 
Bandwidth achieved: 42.85 GB/s

========================================


      Average tokens/sec (total): 4.84                 
Average tokens/sec (first token): 1.40                 
Average tokens/sec (next tokens): 4.89 
                
